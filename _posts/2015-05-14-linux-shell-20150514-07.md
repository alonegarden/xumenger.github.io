---
layout: post
title: Linux常用命令学习7
categories: linux之常用命令
tags: linux shell 命令行 磁盘管理 格式化
---


Linux常用命令学习7---（磁盘管理df du、磁盘的分区和格式化fdisk parted）


## 1.磁盘管理

在服务器的维护中，我们需要关心服务器的磁盘使用了多少、还有多少的剩余空间、某个文件有多大、某个文件夹内的所有文件在一起一共占用的多少空间……问题。以便我们在合适的时机为服务器添加硬盘、分区、管理硬盘文件……操作，让磁盘的利用率最大化

### df：查看磁盘分区使用状况

参数介绍：

* l   仅显示本地磁盘（默认）
* a   显示所有文件系统的磁盘使用情况，包含比如 /proc/、/、等等
* h   以1024进制计算最合适的单位显示磁盘容量，根据实际的文件大小，选择一KB或MB或者GB或者其他单位显示文件大小，否则以KB为单位显示文件大小，
* H   以1000进制计算最合适的单位现实磁盘容量
* T   显示磁盘分区类型，是ext3还是ext4,还是……
* t   显示指定类型文件系统的磁盘分区，比如 df -t ext4 就只会显示ext4类型的文件系统
* x   不显示指定类型文件系统的磁盘分区，和参数 t 是互斥的

例子

* df -l 等价于 df 命令本身
* df -h -t ext4 以合适的单位显示类型为ext4的所有文件系统的信息
* df -hT 以合适的单位显示所有的分区，并且显示这些分区的文件系统类型
* df -hT -x ext4 以合适的单位显示所有文件系统不为ext4类型的分区，并且显示这些分区的文件系统类型

### du：统计磁盘上的文件大小

参数介绍：

* b   以byte为单位统计文件
* k   以KB为单位统计文件，默认是以KB为单位的
* m   以MB为单位统计文件，都是四舍五入的结果
* h   以1024进制计算最合适的单位显示磁盘容量，显示结果更精确
* H   以1000进制计算最合适的单位现实磁盘容量
* s   指定统计目标，比如统计某个指定的文件夹

例子

* du 不加参数的时候，会把当前文件夹遍历一遍，列出当前文件夹下所有文件的大小（以及当前文件夹下的文件夹下的文件，和当前文件夹下的文件夹下的文件夹下的文件……）
* du -s /home/perfect/Desktop    统计/home/perfect/Desktop文件夹的大小，这时候只是针对这个Desktop文件夹，只会显示它的信息，而不会遍历显示该文件夹下的所有的文件和文件夹
* du -m -s /home/perfect/Desktop  统计/home/perfect/Desktop文件夹的大小，并以MB为单位显示
* du -h -s /home/perfect/Desktop  统计/home/perfect/Desktop文件夹的大小，并以合适的单位显示，根据实际大小选择以KB、MB或者GB或者其他进行显示

 
## 2.磁盘的分区和格式化

### 原则

* 主分区和扩展分区总数不能超过四个
* 扩展分区最多只能有一个
* 扩展分区不能直接存取数据，必须在扩展分区内部建立逻辑分区来存储数据

### 在实际的服务器环境中，当硬盘空间消耗殆尽了怎么办

* 更换一块更大的硬盘，这是很不实际的
* 应该在保留原来硬盘的基础上，给服务器添加新的硬盘，这时候就需要在命令行模式下对硬盘进行分区、格式化以及挂载
* 必须对硬盘进行分区、格式化和挂载之后才能在服务器上使用这个硬盘

### 分区模式之MBR

* 主分区不超过4个，所以需要提出扩展分区的概念
* 单个分区容量最大2TB
* fdisk命令对硬盘进行MBR格式的分区（因为目前几乎不使用这个命令，所以等到需要的时候再学习）

### 分区模式之GPT

* 主分区个数“几乎”没有限制，可以有128个。它也有扩展分区（主要用来兼容MBR分区格式）
* 单个分区容量“几乎”没有限制，最大可以时18EB（1EB=1024PB，1PB=1024TB，1TB=1024GB）
* GPT的主分区中不太适合安装X86的系统
* parted命令既可以对硬盘做GPT分区，又可以做MBR分区（因为目前几乎不使用这个命令，所以等到需要的时候再学习）

### 分区的格式化

mkfs命令（因为目前几乎不使用这个命令，所以等到需要的时候再学习）

### 挂载分区

详细参看[Linux学习4](http://xumenger.github.io/linux-shell-20150513-04/)

### SWAP分区

如何给硬盘添加swap分区
 
1. 建立一个普通的Linux分区
2. 修改分区类型的16进制编码
3. 格式化交换分区
4. 启用交换分区