---
layout: post
title: Visual C++开发工具的使用说明
categories: 好资源之开发工具 
tags: c c++ IDE VC++ 开发工具
---

Delphi用久了，Visual C++都忘了怎么用了，最近用VC++开发一个项目，连基本的配置、常见报错解决都不熟了。

所以在此简单的进行整理，以再次熟悉Visual C++的使用。

下面的所有整理都是针对Visual C++ 6.0版本。

## 常用配置

* 新建一个EXE工程：[《 Visual C++如何新建、开发一个程序【例程】》](http://www.xumenger.com/new-visual-cpp-20160503/)
* 新建一个DLL工程：[《Delphi和VC++使用DLL配合开发【例程】》](http://www.xumenger.com/delphi-cpp-dll-20160412/)
* .dll文件是在程序运行时候加载的，在编译的时候用不到
  * 可能需要在代码中指定.dll的路径
  * 然后部署时将.dll放到正确的路径下（是程序对应的目录，而不是源码的对应目录）
* .lib的配置方法
  * VC++配置
    * [工具]-->[选项]-->[目录]，设置“Library files”
    * 将本工程需要引用的.lib文件所在的目录添加一下
    * 不过这样的配置是针对VC++的，而不是针对某个具体的工程的
    * 注意如果'./lib'和'./lib/app'都有.lib文件，那么这两个路径都要在这里配置
    * 【！】所以会作用到以后的所有工程，这样可能就需要小心，有可能产生冲突
  * 具体工程的配置
    * 在[工程]-->[设置]-->[连接]-->[对象/库模块] 这个编辑框中配置编译需要的lib名
    * 保留原有的默认引用的.lib，一般有：kernel32.lib user32.lib gdi32.lib 
    * 还有：winspool.lib comdlg32.lib advapi32.lib shell32.lib ole32.lib 
    * 还有：oleaut32.lib uuid.lib odbc32.lib odbccp32.lib 
    * 然后添加需要的lib，因为已维护好路径，所以再配置.lib的文件名即可
    * 如果有多个lib文件，那么用<空格>进行分割
    * 比如在工程的lib目录下游多个.lib文件，可以在这里添加 lib\test1.lib lib\test2.lib
  * 建议的方式
    * 与某个具体工程相关的还是要使用第二种方式进行配置
    * 与具体工程无关的，想要作用到所有工程上的，使用第一种方式
    * 要将两种区分开来配置，不要混在一起
* .h的配置方式
  * VC++的配置
    * [工具]-->[选项]-->[目录]，设置“Include files”
    * 将本工程所需要的.h文件所在的目录都添加一下
    * 若'./include'和'./include/app'都有.h文件，那这两个路径都要在这里配置
    * 然后在编程时包含.h文件的时候，可以直接`#include "test.h"`，而不用关心它的目录！
    * 【！】所以会作用到以后的所有工程，这样可能就需要小心，有可能产生冲突
  * 具体工程的配置
    * 安装插件“FileTool.exe”，解决VC++“添加文件到目录”、“打开...”崩溃的问题
    * 这个插件的安装方式自己上网搜索
    * 现在就可以通过插件来添加.h文件
    * 点击插件的'A'按钮，添加所有需要的.h文件
    * 对于这种方式的配置的.h文件，还是要在引用时指定路径，比如这个工程的include目录下有.h文件
    * 要`#include "include\test.h"`而不能`#include "test.h"`
  * 建议的方式
    * 与某个具体工程相关的还是要使用第二种方式进行配置
    * 与具体工程无关的，想要作用到所有工程上的，使用第一种方式
    * 并且在引用.h文件时，注意第一种不用致指明路径，第二种还是要指明相对路径
    * 要将两种区分开来配置，不要混在一起
* 【注意！】
  * VC++在[工具]-->[选项]-->[目录]，添加.lib、.h是针对所有工程的
  * 如果移动了.h、.lib的路径还需要再重新配置
  * 一般拷贝别人的工程到本地无法编译一般就是因为这个路径配置的不一致导致的！
* 配置编译输出路径，比如编译输出Exe或者dll文件
  * [工程]-->[设置]-->[连接]-->[输出文件名]，这个编辑框设置：bin/TestApp.exe
  * [工程]-->[设置]-->[连接]-->[输出文件名]，这个编辑框设置：bin/TestApp.dll
* 调试的配置：可以调试EXE、也可以调试DLL
  * 另外参考下面的《调试过程中常见报错和解决方法》
  * [工程]-->[设置]-->[连接]，设置“编译输出路径”，一定要输出在调试用到的路径上
  * [工程]-->[设置]-->[调试]，设置“可执行调试对话”，一定要是调试用到的可执行文件

## 常用快捷键

* Ctrl+F7：Compile(编译)
* F7：Build(组建)
* F9：加断点、去除断点
* F5：开始调试
* F10：单步
* F11：单步进入

## 调试过程中常见报错和解决方法

* 报错：`One or more breakpoints cannot be set and have been disabled. Execution will stop at the beginning of the program`
  * [编辑]-->[断点]-->全部移除
  * [组建]-->[全部重建]，将整个工程完全彻底重新编译组建一遍
  * 补充说明，区分：编译、组建、全部重建
  * 改成Debug模式：[工程]–>[设置]，设置框的左边看到可以设置Debug还是Release模式！
  * [工程]-->[设置]-->[连接]-->勾选“产生调试信息”

## 常见编译报错及解决方法

* Build程序时提示`no compile tool is associated with the file extension`错误
  * 原因是你目前打开的是.h文件，而C++程序中，.h的头文件是不参与编译的。
  * 只需要把其他.c文件或者.cpp文件，双击打开，这时在编译就不会提示了得意
