---
layout: post
title: Linux-C逆向工程基础：程序逻辑分析
categories: 深入学习之逆向工程 c/c++之指针与内存
tags: linux c c++ gcc 汇编 逆向工程 Linux-C逆向工程基础
---

程序的三大逻辑包括：顺序、判断、循环。顺序逻辑不需要多讲，本文主要讲解32位、64下汇编的判断逻辑、循环逻辑

## 判断语句

在C语言中的判断逻辑代码主要是

```c
    //判断
    if(strlen(str) < 6){
        printf("strlen(str) < 6\n");
    }
    else{
        printf("strlen(str) >= 6\n");
    }
```

**32位汇编指令**

其编译得到32位汇编代码如下

```
...
.L6:
	cmpl	$6, -28(%ebp)
	jle	.L7
	movb	$0, -13(%ebp)
	subl	$12, %esp
	leal	-20(%ebp), %eax
	pushl	%eax
	call	strlen
	addl	$16, %esp
	cmpl	$5, %eax
	ja	.L8
	subl	$12, %esp
	pushl	$.LC1
	call	puts
	addl	$16, %esp
	jmp	.L9
.L8:
	subl	$12, %esp
	pushl	$.LC2
	call	puts
	addl	$16, %esp
.L9:
	subl	$12, %esp
    ...
```

**64位汇编指令**

其编译得到64位汇编代码如下

```
...
.L6:
	cmpl	$6, -24(%rbp)
	jle	.L7
	movb	$0, -9(%rbp)
	leaq	-16(%rbp), %rax
	movq	%rax, %rdi
	call	strlen
	cmpq	$5, %rax
	ja	.L8
	movl	$.LC1, %edi
	call	puts
	jmp	.L9
.L8:
	movl	$.LC2, %edi
	call	puts
.L9:
	subq	$8, %rsp
    ...
```

## 循环语句

在C语言中循环语句的代码是

```c
    //循环
    for(i=0; i<7; i++){
        str[i] = 'a';
    }
```

**32位汇编指令**

其编译得到32位汇编代码如下

```
    ...
	movl	$0, -28(%ebp)
	movl	$0, -28(%ebp)
	jmp	.L6
.L7:
	leal	-20(%ebp), %edx
	movl	-28(%ebp), %eax
	addl	%edx, %eax
	movb	$97, (%eax)
	addl	$1, -28(%ebp)
.L6:
	cmpl	$6, -28(%ebp)
	jle	.L7
    ...
```

**64位汇编指令**

其编译得到64位汇编代码如下

```
    ...
	movl	$0, -24(%rbp)
	movl	$0, -24(%rbp)
	jmp	.L6
.L7:
	movl	-24(%rbp), %eax
	cltq
	movb	$97, -16(%rbp,%rax)
	addl	$1, -24(%rbp)
.L6:
	cmpl	$6, -24(%rbp)
	jle	.L7
    ...
```

