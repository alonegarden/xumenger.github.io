---
layout: post
title: Java注解
categories: java之设计模式 java之面向对象
tags: Java 注解 反射 设计模式 python Java5 反射 依赖注入 
---

>[之前](http://www.xumenger.com/talk-java-20180819/)我就讲过Java 中的注解和Python 中的装饰器在最直观的语法层面看起来很像，所以首先推荐一篇[《面向对象编程：Java注解与Python装饰器》](https://alexknight.github.io/java/2018/07/19/annotation-and-decorate.html)

回顾一下在Spring Boot 中编写URL 路由的方式是这样的

```java
package com.example.demo;

import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RestController;

@RestController
public class TestController {
    @RequestMapping("/")
    public String index() {
        return "This is Index Page";
    }
    
    @RequestMapping("/about")
    public String about() {
        return "This is About Page";
    }
    
    @RequestMapping(value="/user/{name}", method= RequestMethod.GET)
    public String user(@PathVariable("name") String name) {
       return "Hello " + name;
    }
}
```

## 一个简单的注解例子

老套路，先不问为什么，而是先看怎么玩，直接看一个Java 注解的例子

```java

```

编译运行的效果是这样的

![image](../media/image/2018-10-14/01.png)

## Java注解

注解是Java5 开始引入的新特征，它提供了一种安全的类似注视的机制，用来将任何的信息或元数据（MetaData）与程序元素（类、方法、成员变量等）进行关联。为程序的元素（类、方法、成员变量等）加上更加直观明了的说明，这些说明信息是与程序的业务逻辑无关，并且供执行的工具或框架使用。注解像一种修饰符一样，应用于包、类型、构造方法、方法、成员变量、参数及本地变量的声明语句中

Java 注解是附加在代码中的一些元信息，用于一些工具在编译、运行时进行解析和使用，起到说明、配置的功能。注解不会也不能影响代码的实际逻辑，仅仅起到辅助性的作用。包含在java.lang.annotation 包中

注解至少有以下作用：

* 生成代码。这是最常见的，也是Java 最早提供的注解。常见的有@param、@return 等
* 跟踪代码依赖性，实现替代配置文件功能。比如Dagger2 依赖注入，未来Java 开发，将大量注解配置
* 在编译时进行格式检查。如@override 放在方法前，如果你这个方法并不是覆盖了超类方法，则编译时就能检查出

注解本质时一个继承了Annotation 的特殊接口，其具体实现类是Java 运行时生成的动态代理类。而我们通过反射获取注解时，返回的是Java 运行时生成的动态代理对象$Proxy1，通过代理对象调用自定义注解（接口）的方法，会最终调用AnnotationInvocationHandler 的invoke 方法。该方法会从memberValues 这个Map 中索引出对应的值。而memberValues 的来源是Java 常量池！

