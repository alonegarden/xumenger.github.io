---
layout: post
title: Spring 循环依赖
categories: java之web开发 java之web框架 Spring之Ioc
tags: java bean IoC 循环依赖 Spring 容器 BeanCurrentlyInCreationException 
---

>参考《Spring技术内幕》、《Spring源码深度解析》

Spring 循环依赖一定是所有稍微深入了解了Spring 之后都会听到的一个知识点，也是大家所谓的面试问题热点

所谓循环依赖是指两个或多个Bean 相互地持有对方，比如A 引用B，B 引用C，C 引用A，最终反映为一个环

![](../media/image/2020-10-26/01.png)

Spring 容器循环依赖包括构造器循环依赖和setter 循环依赖

## 构造器循环依赖

即通过构造器注入构成的循环依赖，这种依赖是无法解决的，只能抛出BeanCurrentlyInCreationException 异常表示依赖

比如创建A的时候，构造器需要B，那么去创建B，创建B 的时又发现依赖C，再去创建C，但是创建C 又发现需要A，那么都无法完成创建

Spring 容器将每一个正在创建的Bean 标识符放在一个“当前创建Bean 池”中，Bean 标识符在创建过程中将一直保持在这个池中，因此如果在创建Bean 过程中发现自己已经在“当前创建Bean 池”里时，抛出BeanCurrentlyInCreationException；而对于创建完毕的Bean 将从“当前创建Bean 池”里清除掉



## setter循环依赖

