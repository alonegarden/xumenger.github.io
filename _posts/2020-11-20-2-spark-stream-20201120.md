---
layout: post
title: Spark 流处理
categories: 大数据之kafka 大数据之spark
tags: scala java 大数据 kafka spark hadoop MapReduce 流处理 分布式 数据清洗 数据处理 HBase Hive Storm Flink
---

因为一些个人工作上的原因，对于当前主流的大数据框架确实缺少应用的需求，但自己也接触过一些相关领域的概念，一直以来有这些问题困扰着我，列一下这些问题，希望本文对这些问题能够有所解答

>Hadoop 的核心是分布式文件系统HDFS 和分布式计算系统Map Reduce。HDFS、Map Reduce 的底层原理是什么样的？

>Hive、HBase 底层的存储都是基于HDFS 的，Hive、HBase 存储数据的存储结构是什么样的？适用于存储什么类型的数据？

>Spark 本身并没有提供分布式文件系统，所以Spark 的分析大多依赖于Hadoop 的分布式文件系统HDFS

>Hadoop 的Map Reduce 与Spark 都可以进行数据计算，而相比于Map Reduce，Spark 的速度更快且功能更丰富，那么其分布式计算的原理有什么异同？

>什么是离线流处理？什么是实时流处理？

>Kafka、Spark、Storm、Flink 的流处理有什么异同？

## 各种流处理框架比较

>[Kafka Stream 以及其他流处理框架对比](https://www.cnblogs.com/zackstang/p/11522194.html)

Storm 是最早的流处理框架，其低延时、高吞吐，适用于复杂度不高的流场景；但是没有状态管理，缺少事件-时间处理、聚合、窗口、Session、watermark 等高级功能；at-least-once 语义

Spark Streaming 非常流行，在Spark 2.0 之后的版本，成为结构化的流（structured streaming），性能提升了很多，并且增加了很多高级功能，例如定制的内存管理、watermark、事件-时间处理等。在2.3.0 版本之后，structured streaming 除了可以（默认）使用micro-batching 处理之外，还可以选择continuous streaming 模式。在micro-batching 模式下，最低延时可达100ms，在continuous streaming 模式下，最低延时可达几毫秒。在大部分real-time 应用场景下，micro-batching 的延时是可以接受的。不过如果有必要实现毫秒级别的延时（比如信用卡交易欺诈之类的），则需要使用continuous streaming

虽然spark streaming 的continuous streaming 可以提供如Storm 与Flink 级别的低延时，不过它仅是一个预览版，尚未完全成熟

Flink 是第一个真正的流处理框架，具有所有高级功能，例如事件-时间处理、watermarks等；低延时、高吞吐，可以根据需求做配置；自适应，相比于Spark 没有太多的参数需要调优；和Spark 一样，Exactly Once 语义。不过其仅在Streaming 中广泛使用，在Batch 场景中使用较少

Kafka 流处理每次处理一个条目，而不像Spark 是微批处理的

Kafka Stream 相较于其他所有流处理框架，是一个轻量级的库。常用于Kafka 中的数据，做一些转换，然后发回Kafka。由于它原生即轻量级，所以适用于一些微服务类型的框架中。Kafka Stream 的部署和使用非常简单，且并不需要额外建立一个集群去运行。它的内部使用的是Kafka Consumer Group，与Kafka Log 的机制共同实现流处理

Kafka Stream 一个最大的优点为：端到端的Exactly Once。启用时也仅需要启用一个flag 即可。另外它是非常轻量级的库，也继承了Kafka 的所有优点，但是它与Kafka 紧密联系，无法在没有Kafka 的场景下使用，另外，相比于Spark Streaming、Flink，不适用于大型业务场景

以上只是转载别人文章中的梳理，具体还得自己经过深入研究和大量对比使用后，才能在更多细节的权衡上有发言权！

## 参考资料

* [Spark 官网](http://spark.apache.org/)
* [Kafka Stream 以及其他流处理框架对比](https://www.cnblogs.com/zackstang/p/11522194.html)
* [Spark项目实战:大数据实时流处理日志(非常详细)](https://blog.csdn.net/qq_41955099/article/details/88959996)